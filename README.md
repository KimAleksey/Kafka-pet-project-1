# –ü—Ä–æ–µ–∫—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã c –∫–ª–∞—Å—Ç–µ—Ä–æ–º Kafka –∏ Schema Registry.

## üíª –ß—Ç–æ –≤ –ø—Ä–æ–µ–∫—Ç–µ

–í –¥–∞–Ω–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –∫–ª–∞—Å—Ç–µ—Ä–æ–º Kafka. 
–î–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Schema Registry.
–í –ø—Ä–æ–µ–∫—Ç–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã.

- ‚úîÔ∏è Docker - –¥–ª—è —Å–±–æ—Ä–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞.
- ‚úîÔ∏è Kafka + ZooKeeper - –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–ª–∞—Å—Ç–µ—Ä–∞ –±—Ä–æ–∫–µ—Ä–∞ —Å–æ–æ–±—â–µ–Ω–∏–π. 3 broker, 3 zookeeper, 1 kafka ui, 1 kafka schema registry.
- ‚úîÔ∏è Kafka Schema Registry - –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Å—Ö–µ–º—ã —Å–æ–æ–±—â–µ–Ω–∏–π.
- ‚úîÔ∏è Python - –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ –∏—Ö –≤ Kafka, –∞ —Ç–∞–∫–∂–µ –¥–ª—è —Å—á–∏—Ç—ã–≤–∞–Ω–∏—è –∏–∑ Kafka.
- ‚úîÔ∏è UV - –º–µ–Ω–µ–¥–∂–µ—Ä –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.

## üìñ –û–ø–∏—Å–∞–Ω–∏–µ

–í —ç—Ç–æ–º –ø—Ä–æ–µ–∫—Ç–µ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ `main.py` –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –æ—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞.
–í `schema_registry.py` –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å—Ö–µ–º—ã —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è topic.
–í `simple_producer.py` —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω Kafka producer, –∫–æ—Ç–æ—Ä—ã–π –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –≤ Kafka topic.
–í `simple_consumer.py` —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω Kafka consumer, –∫–æ—Ç–æ—Ä—ã–π —Å—á–∏—Ç—ã–≤–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ Kafka topic.

–í –ø—Ä–æ–µ–∫—Ç–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:
- ‚úîÔ∏è –°–æ–∑–¥–∞–µ—Ç—Å—è topic –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–π –∑–∞–ø–∏—Å–∏ –≤ –Ω–µ–≥–æ –∏ —Å—á–∏—Ç—ã–≤–∞–Ω–∏—è –∏–∑ –Ω–µ–≥–æ.
- ‚úîÔ∏è –°–æ–∑–¥–∞–µ—Ç—Å—è schema registry –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π –æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.
- ‚úîÔ∏è –ì–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ faker.
- ‚úîÔ∏è –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ Kafka topic. –° –ø–µ—Ä–∏–æ–¥–∏—á–Ω–æ—Å—Ç—å—é 1 —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —Å–µ–∫—É–Ω–¥—É.
- ‚úîÔ∏è –í –ø—Ä–æ—Ü–µ—Å—Å–µ –∑–∞–ø–∏—Å–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ topic –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ schema registry.
- ‚úîÔ∏è –°–æ–æ–±—â–µ–Ω–∏—è –∏–∑ Kafka topic —Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è —Å –ø–æ–º–æ—â—å—é python.
- ‚úîÔ∏è –í –ø—Ä–æ—Ü–µ—Å—Å–µ —Å—á–∏—Ç—ã–≤–∞–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ topic –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ schema registry.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```text
.
‚îú‚îÄ‚îÄ app/                            # –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ producers/                      # Kafka producers
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ simple_producer.py              # –ü—Ä–æ–¥—é—Å–µ—Ä, –æ—Ç–ø—Ä–∞–≤–ª—è—é—â–∏–π –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ consumers/                      # Kafka consumers
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ simple_consumer.py              # Consumer –¥–ª—è —á—Ç–µ–Ω–∏—è –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –∏–∑ Kafka
‚îÇ   ‚îú‚îÄ‚îÄ utils/                          # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –º–æ–¥—É–ª–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ kafka.py                        # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Kafka (bootstrap servers, —Ç–æ–ø–∏–∫–∏)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ schema_registry.py              # –†–∞–±–æ—Ç–∞ —Å–æ Schema Registry –∏ JSON Schema                     
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ generator.py                    # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
‚îÇ   ‚îî‚îÄ‚îÄ main.py                      # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ / orchestration (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
‚îú‚îÄ‚îÄ .env.example                     # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ docker-compose.yaml              # Kafka, Schema Registry, UI
‚îú‚îÄ‚îÄ pyproject.toml                   # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
‚îú‚îÄ‚îÄ uv.lock                          # Lock-—Ñ–∞–π–ª –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
‚îú‚îÄ‚îÄ .python-version                  # –í–µ—Ä—Å–∏—è Python
‚îî‚îÄ‚îÄ README.md                        # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
```

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è:

```bash
git clone https://github.com/KimAleksey/Kafka-cluster-with-schema-registry.git
cd Kafka-cluster-with-schema-registry
```

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

–£—Å—Ç–∞–Ω–æ–≤–∫–∞ uv
```bash
curl -LsSf https://astral.sh/uv/install.sh | sh
```
–ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Ä–º–∏–Ω–∞–ª.

–°–æ–∑–¥–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
```bash
uv venv
```

–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
```bash
source .venv/bin/activate
```

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```bash
uv sync
```

–°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª –æ–∫—Ä—É–∂–µ–Ω–∏—è
```bash
cp .env.example .env
```

### –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

```bash
docker compose up -d
```

## üßë‚Äçüíª–†–∞–±–æ—Ç–∞ —Å –ø—Ä–æ–µ–∫—Ç–æ–º

### –†–∞–±–æ—Ç–∞ —Å Kafka.

1. –ü–µ—Ä–µ–π—Ç–∏ –≤ http://localhost:8888/.

![img.png](docs/images/img_2.png)
2. –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –≤ topic –∏–¥–µ—Ç –∑–∞–ø–∏—Å—å —Å–æ–æ–±—â–µ–Ω–∏–π.

![img.png](docs/images/img_3.png)
3. –í –∫–æ–Ω—Å–æ–ª–∏ –º–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å –≤–æ—Ç —Ç–∞–∫–æ–π –ª–æ–≥:
```text
2026-01-17 02:21:29,978 | INFO | root | Bootstrap server: localhost:29092
2026-01-17 02:21:30,020 | ERROR | root | –ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å —Ç–æ–ø–∏–∫ 'users_coordinates': KafkaError{code=TOPIC_ALREADY_EXISTS,val=36,str="Topic 'users_coordinates' already exists."}
2026-01-17 02:21:30,021 | INFO | root | User coordinates topic: users_coordinates
2026-01-17 02:21:30,021 | INFO | root | Schema registry url: http://localhost:8081
2026-01-17 02:21:30,021 | INFO | root | Schema name: users-coordinates-values
2026-01-17 02:21:30,068 | INFO | root | ‚úÖ –°—Ö–µ–º–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∞. Schema ID: 1
2026-01-17 02:21:30,074 | INFO | root | ‚úÖ –°—Ö–µ–º–∞ users-coordinates-values –ø–æ–ª—É—á–µ–Ω–∞. Schema: {"$schema":"http://json-schema.org/draft-07/schema#","title":"UserCoordinates","type":"object","properties":{"id":{"type":"integer"},"longitude":{"type":"number"},"latitude":{"type":"number"}},"required":["id","longitude","latitude"]}
2026-01-17 02:21:33,491 | INFO | root | Received message: {'id': 2, 'longitude': 150.584389, 'latitude': -14.4893505}
2026-01-17 02:21:33,491 | INFO | root | Received message: {'id': 11, 'longitude': 36.341342, 'latitude': 59.015191}
2026-01-17 02:21:33,491 | INFO | root | Received message: {'id': 90, 'longitude': 94.495258, 'latitude': -34.0614805}
2026-01-17 02:21:33,491 | INFO | root | Received message: {'id': 78, 'longitude': 24.18271, 'latitude': 25.271284}
2026-01-17 02:21:40,457 | INFO | root | –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
{
    "id": 62,
    "longitude": 103.088325,
    "latitude": 2.1956615
}
Delivered to users_coordinates [4]
Delivered to users_coordinates [4]
```
4. –í Shema Registry –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Å—Ö–µ–º—É:
[http://localhost:8081/subjects/users-coordinates-values/versions/1](http://localhost:8081/subjects/users-coordinates-values/versions/1)

### –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ –ø—Ä–æ–µ–∫—Ç—É

#### schema_registry.py

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É Schema Registry –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Å—Ö–µ–º—ã –¥–ª—è –∑–∞–ø–∏—Å–∏ –∏ —Å—á–∏—Ç—ã–≤–∞–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π –æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞—Ö –ø–æ–ª–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

1. –°–æ–∑–¥–∞–µ—Ç—Å—è python —Å–ª–æ–≤–∞—Ä—å —Å–æ —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π:
```python
# –°—Ö–µ–º–∞ –¥–ª—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
USERS_COORDINATES_JSON_SCHEMA = {
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "UserCoordinates",
    "type": "object",
    "properties": {
      "id": {"type": "integer"},
      "longitude": {"type": "number"},
      "latitude": {"type": "number"}
    },
    "required": ["id", "longitude", "latitude"]
}
```
–ó–¥–µ—Å—å –≤–∞–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å, –∫–∞–∫–∏–µ –ø–æ–ª—è –∏ –∫–∞–∫–∏–µ —Ç–∏–ø—ã –º–æ–∂–µ—Ç –∏–º–µ—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –¥–∞–Ω–Ω–æ–π —Å—Ö–µ–º–æ–π.
2. –î–∞–ª–µ–µ –∏–¥–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É Shema registry.
3. –î–∞–ª–µ–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º post –∑–∞–ø—Ä–æ—Å –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Å—Ö–µ–º—ã:
```python
payload = {
    "schemaType": "JSON",
    "schema": json.dumps(json_schema)
}

response = requests.post(
    f"{url}/subjects/{subject}/versions",
    headers={"Content-Type": "application/vnd.schemaregistry.v1+json"},
    json=payload
)
```
–ó–¥–µ—Å—å python —Å–ª–æ–≤–∞—Ä—å —Å–µ—Ä–∏–∞–ª–∏–∑—É–µ—Ç—Å—è –≤ json —Ñ–æ—Ä–º–∞—Ç –∏ –¥–∞–ª–µ–µ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ post –∑–∞–ø—Ä–æ—Å.
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —Å—Ö–µ–º–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª–∞—Å—å –º–æ–∂–Ω–æ –ø–æ —Å—Å—ã–ª–∫–µ:
[http://localhost:8081/subjects/users-coordinates-values/versions/1](http://localhost:8081/subjects/users-coordinates-values/versions/1)

![img.png](docs/images/img_4.png)

#### kafka.py

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Kafka Broker –∏ —Å–æ–∑–¥–∞–Ω–∏—è Topic.

1. –ü–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫ Broker.
2. –ß–µ—Ä–µ–∑ AdminClient –∏ NewTopic —Å–æ–∑–¥–∞–µ–º topic —Å –∑–∞–¥–∞–Ω–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:
```python
create_topic(
    topic_name="users_coordinates",
    num_partitions=6,
    replication_factor=2,
    min_insync_replicas=1,
    bootstrap_servers=bootstrap_serv
)
```
3. –ó–∞–π—Ç–∏ –≤ UI Kafka. 
[URL](http://localhost:8888/ui/clusters/local/all-topics?perPage=25)

![img_1.png](docs/images/img_1.png)

4. –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ —Ç–æ–ø–∏–∫ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç.

![img.png](docs/images/img.png)


#### generator.py

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ Faker –¥–ª—è –∏–º–∏—Ç–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö.
–î–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ:
```python
user_coordinates = {
    "id": random.randint(1,100),
    "longitude": float(fake.longitude()),
    "latitude": float(fake.latitude()),
}
```

#### simple_producer.py

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ Kafka topic.

1. –ü–æ–ª—É—á–∞–µ–º —Å–µ—Ä–≤–µ—Ä –±—Ä–æ–∫–µ—Ä–∞, —Ç–æ–ø–∏–∫, —Å–µ—Ä–≤–µ—Ä Schema Registry, JSON —Å—Ö–µ–º—ã –≤ —Ñ–æ—Ä–º–∞—Ç–µ python —Å–ª–æ–≤–∞—Ä—è.
2. JSON —Å—Ö–µ–º—ã —Å–µ—Ä–∏–∞–ª–∏–∑—É–µ–º –≤ JSON —Ñ–æ—Ä–º–∞—Ç –≤ –≤–∏–¥–µ —Å—Ç—Ä–æ–∫–∏.
3. –°–æ–∑–¥–∞–µ–º —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä JSONSerializer –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ Kafka —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ö–µ–º–µ.
4. –°–æ–∑–¥–∞–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Producer.

```python
producer_conf = {
    # –ê–¥—Ä–µ—Å Kafka –±—Ä–æ–∫–µ—Ä–æ–≤
    "bootstrap.servers": bootstrap_server,

    # –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä –∫–ª—é—á–∞ —Å–æ–æ–±—â–µ–Ω–∏–π ‚Äî –∑–¥–µ—Å—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è IntegerSerializer, —Ç–∞–∫ –∫–∞–∫ –∫–ª—é—á "id" —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω—ã–π
    "key.serializer": StringSerializer("utf_8"),

    # –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä –∑–Ω–∞—á–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π ‚Äî JSONSerializer –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–ª–æ–≤–∞—Ä—è Python –∫–∞–∫ JSON
    "value.serializer": json_serializer,

    # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–π –æ—Ç –±—Ä–æ–∫–µ—Ä–æ–≤ –¥–ª—è –∑–∞–ø–∏—Å–∏ —Å–æ–æ–±—â–µ–Ω–∏—è (–≤—Å–µ)
    "acks": -1,

    # –†–∞–∑–º–µ—Ä –ø–∞–∫–µ—Ç–∞ –≤ 1000 –±–∞–π—Ç. –ö–æ–≥–¥–∞ –Ω–∞–∫–æ–ø–∏—Ç—Å—è –Ω—É–∂–Ω—ã–π –æ–±—ä–µ–º - –∑–∞–ø–∏—à–µ—Ç—Å—è –≤ Kafka
    "batch.size": 1000,

    # –ñ–¥–∞—Ç—å –¥–æ 10 —Å–µ–∫—É–Ω–¥—ã, —á—Ç–æ–±—ã —Å–æ–±—Ä–∞—Ç—å –±–æ–ª—å—à–µ —Å–æ–æ–±—â–µ–Ω–∏–π. –°—Ä–∞–±–æ—Ç–∞–µ—Ç –ª–∏–±–æ –ø–æ —Ä–∞–∑–º–µ—Ä—É, –ª–∏–±–æ –ø–æ –≤—Ä–µ–º–µ–Ω–∏.
    "linger.ms": 10000,

    # –í–∫–ª—é—á–∞–µ—Ç –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å, —á—Ç–æ–±—ã –Ω–µ –±—ã–ª–æ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ —Å–æ–æ–±—â–µ–Ω–∏–π –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–µ.
    "enable.idempotence": True,

    # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –ø—Ä–∏ —Å–±–æ—è—Ö
    "retries": 100,

    # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–æ–±—â–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ —á–µ—Ä–µ–∑ –æ–¥–Ω–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ.
    # –í —Å–æ—á–µ—Ç–∞–Ω–∏–∏ —Å –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å—é –Ω—É–∂–Ω–æ –¥–µ—Ä–∂–∞—Ç—å ‚â§ 5, –∏–Ω–∞—á–µ –≤–æ–∑–º–æ–∂–Ω—ã –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π.
    "max.in.flight.requests.per.connection": 1,
}
```
–ò–∑ –≤–∞–∂–Ω–æ–≥–æ:
- –°–µ–º–∞–Ω—Ç–∏–∫–∞ –¥–æ—Å—Ç–∞–≤–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º acks. –í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ -1 (all) –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –ø—Ä–∏ –∑–∞–ø–∏—Å–∏ –≤ Kafka producer –æ–∂–∏–¥–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ—Ç –º–∞—Å—Ç–µ—Ä –±—Ä–æ–∫–µ—Ä–∞ –∏ –æ—Ç –≤—Å–µ—Ö in sync replica.
- –†–∞–∑–º–µ—Ä –ø–∞–∫–µ—Ç–∞ –∏–ª–∏ –ª–∏–º–∏—Ç –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏: batch.size –∏ linger.ms. –°—Ä–∞–±–æ—Ç–∞–µ—Ç –æ–¥–Ω–æ –∏–∑ –¥–≤—É—Ö - —Ç–æ –µ—Å—Ç—å –≤ Kafka –æ—Ç–ø—Ä–∞–≤–∏—Ç—Å—è batch —Å–æ–æ–±—â–µ–Ω–∏–π –µ—Å–ª–∏ –Ω–∞–±—Ä–∞–ª—Å—è –Ω—É–∂–Ω—ã–π —Ä–∞–∑–º–µ—Ä batch –∏–ª–∏ –ø—Ä–æ—à–ª–æ –ø–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è.
- –î–ª—è –≥–∞—Ä–∞–Ω—Ç–∏–∏, —á—Ç–æ –∑–∞–ø–∏—Å—å –ø—Ä–∏–¥–µ—Ç —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑, –¥–∞–∂–µ –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–µ - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–∞—Ä–∞–º–µ—Ç—Ä enable.idempotence.
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º retries.

5. –°–æ–∑–¥–∞–Ω–∏–µ —Å–∞–º–æ–≥–æ Producer –Ω–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Å–ª–æ–≤–∞—Ä—è.

```python
producer = SerializingProducer(producer_conf)
```

–ó–¥–µ—Å—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è SerializingProducer, —Ç–∞–∫ –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞—Å—Ç–æ–º–Ω—ã–π —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ö–µ–º–µ.

6. –î–∞–ª–µ–µ –≤ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–º —Ü–∏–∫–ª–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ Kafka.

–î–ª—è —ç—Ç–æ–≥–æ:
- –î–µ–ª–∞–µ–º produce. –ù–ï –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ —Å—Ä–∞–∑—É, –∞ –∫–ª–∞–¥—ë—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –ª–æ–∫–∞–ª—å–Ω—ã–π buffer. –ï—Å–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —É–ø–∞–¥—ë—Ç –¥–æ poll/flush ‚Äî —Å–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–æ–ø–∞–¥—ë—Ç
- –î–µ–ª–∞–µ–º poll. –†–µ–∞–ª—å–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ buffer –≤ Kafka. –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –æ—Ç–≤–µ—Ç—ã –æ—Ç –±—Ä–æ–∫–µ—Ä–æ–≤.
- –î–µ–ª–∞–µ–º flush. –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤–Ω–µ—à—Ç–∞—Ç–Ω–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã.

–î–ª—è produce –≤–∞–∂–Ω–æ.
> - –°–æ–æ–±—â–µ–Ω–∏–µ –Ω–µ —É—Ö–æ–¥–∏—Ç –≤ —Å–µ—Ç—å –º–≥–Ω–æ–≤–µ–Ω–Ω–æ.
> - –û–Ω–æ –∫–ª–∞–¥—ë—Ç—Å—è –≤ –≤–Ω—É—Ç—Ä–µ–Ω–Ω—é—é –æ—á–µ—Ä–µ–¥—å `librdkafka`.
> - `poll()` –∏–ª–∏ `flush()` —Å–ª—É–∂–∞—Ç –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –∫–ª–∏–µ–Ω—Ç –æ–±—Ä–∞–±–æ—Ç–∞–ª –æ—á–µ—Ä–µ–¥—å:
>   - –æ—Ç–ø—Ä–∞–≤–∏–ª –±–∞—Ç—á–∏, –∫–æ—Ç–æ—Ä—ã–µ –≥–æ—Ç–æ–≤—ã
>   - –ø–æ–ª—É—á–∏–ª –æ—Ç–≤–µ—Ç—ã –æ—Ç –±—Ä–æ–∫–µ—Ä–æ–≤
>   - –≤—ã–∑–≤–∞–ª –∫–æ–ª–±—ç–∫–∏ –¥–æ—Å—Ç–∞–≤–∫–∏

7. –í —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–∞–∫–∏—Ö –ª–∏–±–æ –ø–æ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –æ–ø–∏—Å–∞–Ω—ã –≤ —Å—Ö–µ–º–µ, –ø—Ä–∏ –∑–∞–ø–∏—Å–∏ –≤ kafka –±—É–¥–µ—Ç –æ—à–∏–±–∫–∞.

```text
During handling of the above exception, another exception occurred:
confluent_kafka.error.ValueSerializationError: KafkaError{code=_VALUE_SERIALIZATION,val=-161,str="'latitude' is a required property"
```

8. –î–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–æ –ø–∞—Ä—Ç–∏—Ü–∏—è–º –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–ª—é—á.

```python
# –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ Kafka
producer.produce(
    topic=users_coordinates_topic,  # –¢–æ–ø–∏–∫, –∫—É–¥–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
    key=str(data["id"]),            # –ö–ª—é—á —Å–æ–æ–±—â–µ–Ω–∏—è (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è)
    value=data,                     # –ó–Ω–∞—á–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è (—Å–ª–æ–≤–∞—Ä—å —Å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏)
    on_delivery=delivery_report,    # –ö–æ–ª–±—ç–∫, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –¥–æ—Å—Ç–∞–≤–∫–∏ (–∏–ª–∏ –æ—à–∏–±–∫–∏)
)
```

#### simple_consumer.py

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π –∏–∑ topic –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∏—Ö –≤ –∫–æ–Ω—Å–æ–ª–∏.

1. –ü–æ–ª—É—á–∞–µ–º —Å–µ—Ä–≤–µ—Ä –±—Ä–æ–∫–µ—Ä–∞, —Ç–æ–ø–∏–∫, —Å–µ—Ä–≤–µ—Ä Schema Registry, JSON —Å—Ö–µ–º—ã –≤ —Ñ–æ—Ä–º–∞—Ç–µ python —Å–ª–æ–≤–∞—Ä—è.
2. JSON —Å—Ö–µ–º—ã —Å–µ—Ä–∏–∞–ª–∏–∑—É–µ–º –≤ JSON —Ñ–æ—Ä–º–∞—Ç –≤ –≤–∏–¥–µ —Å—Ç—Ä–æ–∫–∏.
3. –°–æ–∑–¥–∞–µ–º –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä JSONDeserializer –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π –∏–∑ Kafka –∏ –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –µ–≥–æ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ö–µ–º–µ.
4. –°–æ–∑–¥–∞–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Consumer.

```python
# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Consumer.
python_consumer_conf = {
    # –ê–¥—Ä–µ—Å Kafka –±—Ä–æ–∫–µ—Ä–æ–≤
    "bootstrap.servers": bootstrap_server,

    # Consumer –≥—Ä—É–ø–ø–∞.
    "group.id": "simple_consumer.py",

    # Kafka –Ω–∞—á–∏–Ω–∞–µ—Ç —á–∏—Ç–∞—Ç—å —Å–Ω–∞—á–∞–ª–∞, –µ—Å–ª–∏ offset –Ω–µ –∑–∞–¥–∞–Ω –∏ –Ω–µ –Ω–∞–π–¥–µ–Ω –¥–ª—è Consumer.
    "auto.offset.reset": "earliest",

    # Kafka —Å–∞–º–∞ –æ—Ç–º–µ—Ç–∏—Ç, —á—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–æ —ç—Ç–æ–≥–æ —Å–º–µ—â–µ–Ω–∏—è –ø—Ä–æ—á–∏—Ç–∞–Ω—ã.
    "enable.auto.commit": auto_commit,

    # –î–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä –∫–ª—é—á–∞.
    "key.deserializer": StringDeserializer("utf-8"),

    # –î–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä –∑–Ω–∞—á–µ–Ω–∏—è.
    "value.deserializer": json_deserializer,
}
```

–ò–∑ –≤–∞–∂–Ω–æ–≥–æ:
- –î–ª—è —É–∫–∞–∑–∞–Ω–∏—è –≥—Ä—É–ø–ø—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è group.id.
> group.id –≤ Kafka Consumer ‚Äî —ç—Ç–æ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –≥—Ä—É–ø–ø—ã –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–µ–π. 
> –û–Ω –Ω—É–∂–µ–Ω –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã Kafka –º–æ–≥–ª–∞ —É–ø—Ä–∞–≤–ª—è—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º —Å–æ–æ–±—â–µ–Ω–∏–π –º–µ–∂–¥—É –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ Consumer –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Å–º–µ—â–µ–Ω–∏—è (offsets).
- –î–ª—è —É–∫–∞–∑–∞–Ω–∏—è —Å –∫–∞–∫–æ–≥–æ offset —á–∏—Ç–∞—Ç—å –µ—Å–ª–∏ offset –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ Consumer –Ω–µ –∑–∞–¥–∞–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–∞—Ä–∞–º–µ—Ç—Ä auto.offset.reset.
- –î–ª—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∞—Ü–∏–∏ —Ñ–∏–∫—Å–∞—Ü–∏–∏ offset –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–∞—Ä–∞–º–µ—Ç—Ä enable.auto.commit.
- –î–ª—è –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ã key.deserializer –∏ value.deserializer.

5. –°–æ–∑–¥–∞–µ—Ç—Å—è Consumer —Å —Ä–∞–Ω–µ–µ –∑–∞–¥–∞–Ω–Ω—ã–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–º —Å–ª–æ–≤–∞—Ä–µ–º —Å –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–æ—Ç–æ—Ä–æ–º –∏ –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Å—Ö–µ–º—ã.
6. –í —Å–ª—É—á–∞–µ –µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω–æ, —Å –∫–∞–∫–æ–≥–æ offset –Ω–∞—á–∞—Ç—å —á–∏—Ç–∞—Ç—å - —Å–æ–∑–¥–∞–µ—Ç—Å—è –ø–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ topic, –∏–Ω–∞—á–µ - –ø—Ä–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è offset –≤—Ä—É—á–Ω—É—é, —Å –∫–∞–∫–æ–≥–æ —á–∏—Ç–∞—Ç—å.

```python
if not reset_offsets:
    # –ü–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ –ø–∞—Ä—Ç–∏—Ü–∏–π
    partitions = consumer.list_topics(users_coordinates_topic).topics[users_coordinates_topic].partitions
    # –í—Ä—É—á–Ω—É—é –∑–∞–¥–∞—ë–º offset –¥–ª—è –∫–∞–∂–¥–æ–π –ø–∞—Ä—Ç–∏—Ü–∏–∏.
    consumer.assign([TopicPartition(users_coordinates_topic, p, 0) for p in partitions])
    logging.info("Offsets –¥–ª—è –≤—Å–µ—Ö –ø–∞—Ä—Ç–∏—Ü–∏–π —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –Ω–∞ 0.")
else:
    # –ü–æ–¥–ø–∏—Å—ã–≤–∞–µ–º—Å—è –Ω–∞ topic, Kafka —Å–∞–º–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å –∫–∞–∫–æ–≥–æ offset –Ω–∞—á–∞—Ç—å.
    consumer.subscribe([users_coordinates_topic])
```

7. –í –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–º —Ü–∏–∫–ª–µ —Å—á–∏—Ç—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ Topic.

–î–ª—è —ç—Ç–æ–≥–æ:
- –î–µ–ª–∞–µ–º poll –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ–¥–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è.
> - poll(timeout) –ø—ã—Ç–∞–µ—Ç—Å—è –ø–æ–ª—É—á–∏—Ç—å –æ–¥–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ Kafka.
> - –ü–∞—Ä–∞–º–µ—Ç—Ä 1.0 = —Ç–∞–π–º-–∞—É—Ç –≤ —Å–µ–∫—É–Ω–¥–∞—Ö, —Ç–æ –µ—Å—Ç—å poll –±—É–¥–µ—Ç –∂–¥–∞—Ç—å –¥–æ 1 —Å–µ–∫—É–Ω–¥—ã, –µ—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–∫–∞ –Ω–µ—Ç. 
> - –µ—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –Ω–µ—Ç –ø–æ—Å–ª–µ —Ç–∞–π–º-–∞—É—Ç–∞, poll –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç None.
- –ï—Å–ª–∏ poll –≤—ã–∑–≤–∞–ª –æ—à–∏–±–∫—É ValueDeserializationError, —Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç —á—Ç–æ –ø–æ–ª—É—á–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å—Ö–µ–º–µ. –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –µ–≥–æ.
- –ï—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –Ω–µ—Ç, poll –≤–µ—Ä–Ω—É–ª None ‚Üí –ø—Ä–æ—Å—Ç–æ –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º —Ü–∏–∫–ª
- –ï—Å–ª–∏ –ø—Ä–∏—à–ª–∞ –æ—à–∏–±–∫–∞ KafkaError, —Ç–æ –Ω–µ—á–µ–≥–æ —á–∏—Ç–∞—Ç—å –±–æ–ª—å—à–µ ‚Üí –ø—Ä–æ—Å—Ç–æ –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º —Ü–∏–∫–ª
- –î–µ—Å–µ—Ä–∏–∞–ª–∏–∑—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–∏ value().
- –ï—Å–ª–∏ –≤—Å–µ –æ–∫ –∏ –∞–≤—Ç–æ–∫–æ–º–º–∏—Ç - False, —Ç–æ –¥–µ–ª–∞–µ–º —Ä—É—á–Ω–æ–π –∫–æ–º–º–∏—Ç offset.
- –ï—Å–ª–∏ –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ - –ø—Ä–æ–ø—É—Å–∫–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ.